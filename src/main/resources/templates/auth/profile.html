<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{layout :: layout}">
<head>
    <title>Profile - FitnessApp</title>
</head>
<body>
    <div th:fragment="content">
        <h2 class="mb-4">My Profile</h2>
        <div th:if="${successMessage}" class="alert alert-success alert-dismissible fade show" role="alert">
            <span th:text="${successMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div th:if="${errorMessage}" class="alert alert-danger alert-dismissible fade show" role="alert">
            <span th:text="${errorMessage}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div class="row">
            <div class="col-md-8">
                <form th:action="@{/profile}" method="post">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                    <div class="mb-3">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" class="form-control" id="username" th:value="${user.username}" readonly>
                        <small class="form-text text-muted">Username cannot be changed</small>
                    </div>
                    <div class="mb-3">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" th:value="${user.email}" readonly>
                        <small class="form-text text-muted">Email cannot be changed</small>
                    </div>
                    <div class="mb-3">
                        <label for="gender" class="form-label">Gender</label>
                        <input type="text" class="form-control" id="gender" 
                               th:value="${user.gender != null ? (user.gender.name() == 'M' ? 'Male' : (user.gender.name() == 'F' ? 'Female' : 'Other')) : 'Not set'}" 
                               readonly>
                        <small class="form-text text-muted">Gender cannot be changed</small>
                    </div>
                    <div class="mb-3">
                        <label for="heightCm" class="form-label">Height (cm)</label>
                        <input type="number" class="form-control" id="heightCm" th:value="${user.heightCm}" readonly>
                        <small class="form-text text-muted">Height cannot be changed</small>
                    </div>
                    <div class="mb-3">
                        <label for="age" class="form-label">Age</label>
                        <input type="number" class="form-control" id="age" name="age" th:value="${user.age}" min="1" max="150">
                    </div>
                    <div class="mb-3">
                        <label for="currentWeightKg" class="form-label">Current Weight (kg)</label>
                        <input type="number" step="0.1" class="form-control" id="currentWeightKg" name="currentWeightKg" th:value="${user.currentWeightKg}" min="1" max="500">
                    </div>
                    <div class="mb-3">
                        <label for="goal" class="form-label">Goal</label>
                        <select class="form-select" id="goal" name="goal">
                            <option value="">Select...</option>
                            <option value="LOSE" th:selected="${user.goal != null && user.goal.name() == 'LOSE'}">Lose Weight</option>
                            <option value="GAIN" th:selected="${user.goal != null && user.goal.name() == 'GAIN'}">Gain Weight</option>
                            <option value="MAINTAIN" th:selected="${user.goal != null && user.goal.name() == 'MAINTAIN'}">Maintain Weight</option>
                        </select>
                    </div>
                    <button type="submit" class="btn btn-primary">Update Profile</button>
                </form>
            </div>
        </div>
    </div>
    <div th:fragment="scripts"></div>
</body>
</html>

